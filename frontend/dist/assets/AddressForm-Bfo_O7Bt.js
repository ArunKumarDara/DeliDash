import{ac as m,Y as w,a as b,j as e,B as g,t as f}from"./index-DEobh6A_.js";import{u as C,F as S,a as d,b as l,L as c,c as i,d as h,s as v,o as N,e as E,f as F,g as u}from"./form-BNT2L6qP.js";import{D as A,a as D,b as T,c as P,S as H}from"./switch-B3k3Gvpn.js";import{I as p}from"./input-DYsMVvf_.js";import{S as I,a as O,b as V,c as k,d as x}from"./select-Bhfwh6I5.js";const Y=async(o=1)=>{var a,s;try{return(await m.get("/address/get",{params:{page:o,limit:4},withCredentials:!0})).data}catch(n){const t=n;throw new Error(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||t.message||"Failed to fetch addresses. Please try again.")}},q=async o=>{var a,s;try{return(await m.post("/address/add",o,{headers:{"Content-Type":"application/json"},withCredentials:!0})).data}catch(n){const t=n;throw new Error(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||t.message||"Failed to add address. Please try again.")}},$=async o=>{var a,s;try{return console.log(o),(await m.delete("/address/delete",{params:{addressId:o},withCredentials:!0})).data}catch(n){const t=n;throw new Error(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||t.message||"Failed to delete address. Please try again.")}},z=async o=>{var a,s;try{return(await m.put(`/address/setDefault/${o}`,{},{withCredentials:!0})).data}catch(n){const t=n;throw new Error(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||t.message||"Failed to set default address. Please try again.")}},B=N({receiverName:u().min(5,"name is too short"),address:u().min(5,"Address is too short"),phoneNumber:u().min(10,"Invalid phone number"),type:F(["Home","Office","Other"]),isDefault:E()});function G({openAddressForm:o,setOpenAddressForm:a}){const s=C({resolver:v(B),defaultValues:{address:"",phoneNumber:"",type:"Home",isDefault:!1}}),n=w(),{mutate:t,isPending:j}=b({mutationFn:q,onSuccess:()=>{f("Address added successfully!"),n.invalidateQueries({queryKey:["addresses"]}),s.reset(),a(!1)},onError:r=>{f(r.message||"Failed to add address.")}}),y=r=>{t(r)};return e.jsx(A,{open:o,onOpenChange:a,children:e.jsxs(D,{children:[e.jsx(T,{children:e.jsx(P,{children:"Add New Address"})}),e.jsx(S,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(y),className:"space-y-4",children:[e.jsx(d,{control:s.control,name:"receiverName",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{children:"Receiver Name"}),e.jsx(i,{children:e.jsx(p,{...r,placeholder:"Enter receiver name"})}),e.jsx(h,{})]})}),e.jsx(d,{control:s.control,name:"address",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{children:"Address"}),e.jsx(i,{children:e.jsx(p,{...r,placeholder:"Enter your address"})}),e.jsx(h,{})]})}),e.jsx(d,{control:s.control,name:"phoneNumber",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{children:"Phone Number"}),e.jsx(i,{children:e.jsx(p,{...r,placeholder:"Enter phone number"})}),e.jsx(h,{})]})}),e.jsx(d,{control:s.control,name:"type",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{children:"Address Type"}),e.jsxs(I,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(i,{children:e.jsx(O,{children:e.jsx(V,{placeholder:"Select type"})})}),e.jsxs(k,{children:[e.jsx(x,{value:"Home",children:"Home"}),e.jsx(x,{value:"Office",children:"Office"}),e.jsx(x,{value:"Other",children:"Other"})]})]}),e.jsx(h,{})]})}),e.jsx(d,{control:s.control,name:"isDefault",render:({field:r})=>e.jsxs(l,{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Set as Default"}),e.jsx(i,{children:e.jsx(H,{checked:r.value,onCheckedChange:r.onChange})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{type:"submit",disabled:j,children:j?e.jsxs("span",{className:"flex gap-1 items-center",children:[e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.2s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.1s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce"})]}):"Save Address"}),e.jsx(g,{variant:"outline",onClick:()=>a(!1),children:"Cancel"})]})]})})]})})}export{G as A,$ as d,Y as f,z as s};
