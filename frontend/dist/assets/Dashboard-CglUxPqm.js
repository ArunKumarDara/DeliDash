import{b as P,j as e,c as E,Y,r as h,a as W,B as v,ad as ue,ae as he,af as xe,ag as $,T as Qe,t as B,a4 as Ue,a5 as Ke,a6 as Ge,a7 as Ye,a8 as We,a9 as Xe,aa as Je,ab as Ze,e as es,x as me,y as ss,d as ts,R as as,h as pe,A as rs,P as ns,g as F,z as je,D as ls,N as is,J as os,K as cs,ah as ds,ai as U}from"./index-DEobh6A_.js";import{P as us,T as hs,a as xs,b as ee,c as se}from"./tabs-BDi6gIlt.js";import{C as _,a as M,b as R,c as A,e as ge,d as ms}from"./card-Bt_bnveW.js";import{u as fe}from"./useInfiniteQuery-B3IAkMr7.js";import{b as ps,d as js,g as gs}from"./restaurant-hNCvITC0.js";import{a as fs,g as ys}from"./menu-qdbHKbFj.js";import{u as ye,F as ve,a as C,b as T,c as k,d as S,s as be,o as Ne,e as z,g as L,h as vs,i as V,L as bs,j as Ns}from"./form-BNT2L6qP.js";import{I as D}from"./input-DYsMVvf_.js";import{D as we,d as Ce,a as Te,b as ke,c as Pe,e as Se,f as ws,S as Cs}from"./switch-B3k3Gvpn.js";import{e as Ts,f as ae,S as ks,a as Ps,b as Ss,c as Ds,d as K,R as _s}from"./select-Bhfwh6I5.js";import{u as Ms,a as Rs}from"./order-YtmGo7Q_.js";import{B as te}from"./badge-DKEvF8Xs.js";import{u as As}from"./payment-WWmE9wG0.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],De=P("EllipsisVertical",Es);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ls=P("Info",Fs);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],Is=P("ListOrdered",Os);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Hs=P("Pencil",qs);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],_e=P("Plus",Vs);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Me=P("RefreshCw",zs);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Bs=P("Settings",$s);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Us=P("SquarePen",Qs);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Gs=P("Trash2",Ks);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Ws=P("Trash",Ys);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],Re=P("Utensils",Xs);function Ae({className:s,...t}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:E("w-full caption-bottom text-sm",s),...t})})}function Ee({className:s,...t}){return e.jsx("thead",{"data-slot":"table-header",className:E("[&_tr]:border-b",s),...t})}function Fe({className:s,...t}){return e.jsx("tbody",{"data-slot":"table-body",className:E("[&_tr:last-child]:border-0",s),...t})}function G({className:s,...t}){return e.jsx("tr",{"data-slot":"table-row",className:E("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...t})}function N({className:s,...t}){return e.jsx("th",{"data-slot":"table-head",className:E("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}function w({className:s,...t}){return e.jsx("td",{"data-slot":"table-cell",className:E("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}const Js=Ne({name:L().min(2,"Name must be at least 2 characters"),price:vs.number().min(1,"Price must be greater than 0"),description:L().optional().default(""),isVeg:z(),available:z(),isBestseller:z(),isSpicy:z()});function Zs({restaurantId:s,restaurantName:t,trigger:a}){const r=Y(),[i,d]=h.useState(!1),{mutate:u,isPending:g}=W({mutationFn:n=>fs(n),onSuccess:()=>{r.invalidateQueries({queryKey:["menu",s]}),o.reset(),d(!1)}}),o=ye({resolver:be(Js),defaultValues:{name:"",price:0,description:"",isVeg:!1,available:!0,isBestseller:!1,isSpicy:!1}}),p=async n=>{u({...n,restaurantId:s,description:n.description||""})};return e.jsxs(we,{open:i,onOpenChange:d,children:[e.jsx(Ce,{asChild:!0,children:a}),e.jsxs(Te,{children:[e.jsx(ke,{children:e.jsxs(Pe,{children:["Add Menu Item to ",t]})}),e.jsx(ve,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(p),className:"grid gap-4 py-4",children:[e.jsx(C,{control:o.control,name:"name",render:({field:n})=>e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Item Name",...n})}),e.jsx(S,{})]})}),e.jsx(C,{control:o.control,name:"price",render:({field:n})=>e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(D,{type:"number",placeholder:"Price",...n})}),e.jsx(S,{})]})}),e.jsx(C,{control:o.control,name:"description",render:({field:n})=>e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Description",...n})}),e.jsx(S,{})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(C,{control:o.control,name:"isVeg",render:({field:n})=>e.jsx(T,{children:e.jsx(k,{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.value,onChange:c=>n.onChange(c.target.checked)}),"Vegetarian"]})})})}),e.jsx(C,{control:o.control,name:"available",render:({field:n})=>e.jsx(T,{children:e.jsx(k,{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.value,onChange:c=>n.onChange(c.target.checked)}),"Available"]})})})}),e.jsx(C,{control:o.control,name:"isBestseller",render:({field:n})=>e.jsx(T,{children:e.jsx(k,{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.value,onChange:c=>n.onChange(c.target.checked)}),"Bestseller"]})})})}),e.jsx(C,{control:o.control,name:"isSpicy",render:({field:n})=>e.jsx(T,{children:e.jsx(k,{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.value,onChange:c=>n.onChange(c.target.checked)}),"Spicy"]})})})})]}),e.jsx(Se,{children:e.jsx(v,{type:"submit",disabled:g,children:g?"Adding...":"Add Item"})})]})})]})]})}function et({restaurant:s,menuItems:t=[],isLoading:a,error:r,refetchMenu:i}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-medium",children:"Menu Items"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>i(),disabled:a,children:[e.jsx(Me,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),"Refresh"]}),e.jsx(Zs,{restaurantName:s.name,restaurantId:s._id,trigger:e.jsxs(v,{size:"sm",className:"gap-1",children:[e.jsx(_e,{className:"h-4 w-4"})," Add Item"]})})]})]}),a?e.jsx("div",{children:"Loading menu items..."}):r?e.jsxs("div",{children:["Error loading menu: ",r.message]}):t.length?e.jsxs(Ae,{children:[e.jsx(Ee,{children:e.jsxs(G,{children:[e.jsx(N,{children:"Name"}),e.jsx(N,{children:"Price"}),e.jsx(N,{children:"Description"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(Fe,{children:t.map(d=>e.jsxs(G,{children:[e.jsx(w,{className:"font-medium",children:d.name}),e.jsxs(w,{children:["₹",d.price]}),e.jsx(w,{children:d.description}),e.jsx(w,{className:"text-right",children:e.jsxs(ue,{children:[e.jsx(he,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",children:e.jsx(De,{className:"h-4 w-4"})})}),e.jsxs(xe,{align:"end",children:[e.jsxs($,{children:[e.jsx(Us,{className:"h-4 w-4 mr-2"})," Edit"]}),e.jsxs($,{className:"text-red-600",children:[e.jsx(Ws,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},d._id))})]}):e.jsx("div",{className:"text-center py-4 text-sm text-muted-foreground",children:"No menu items found for this restaurant"})]})}function st({restaurant:s,onDelete:t,isDeleting:a}){const[r,i]=h.useState(!1),{data:d,isLoading:u,error:g,refetch:o}=Qe({queryKey:["menu",s._id],queryFn:()=>ys({restaurantId:s._id,pageParam:1,search:"",category:""}),enabled:r,staleTime:1e3*60*5}),p=()=>{i(!r)};return e.jsxs(_,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between cursor-pointer",onClick:p,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded-md bg-secondary",children:e.jsx(Re,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx(R,{className:"mb-2",children:s.name}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs ${s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:n=>{n.stopPropagation()},children:e.jsx(Hs,{className:"h-4 w-4"})}),e.jsx(v,{variant:"destructive",size:"sm",onClick:n=>{n.stopPropagation(),t(s._id)},disabled:a,children:a?"Deleting...":e.jsx(Gs,{className:"h-4 w-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:p,children:r?e.jsx(Ts,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})})]})]}),r&&e.jsx(A,{className:"space-y-4",children:e.jsx(et,{restaurant:s,menuItems:d==null?void 0:d.data,isLoading:u,error:g,refetchMenu:o})})]})}const tt=Ne({name:L().min(2,{message:"Name must be at least 2 characters."}),phoneNumber:L().min(10,{message:"Phone number must be at least 10 digits."}),avatar:Ns(File).optional(),address:L().min(5,{message:"Address must be at least 5 characters."}),cuisineType:L().min(1,{message:"Please select a cuisine type."}),status:z()});function at({open:s,onOpenChange:t,trigger:a}){const[r,i]=h.useState(null),d=Y(),u=ye({resolver:be(tt),defaultValues:{name:"",phoneNumber:"",address:"",cuisineType:"",status:!0}}),{mutate:g,isPending:o}=W({mutationFn:ps,onSuccess:()=>{d.invalidateQueries({queryKey:["restaurants"]}),u.reset(),t(!1),B.success("Restaurant added successfully!")},onError:c=>{B.error(`Failed to add restaurant: ${c.message}`)}}),p=c=>{g(c)},n=c=>{var l;const y=(l=c.target.files)==null?void 0:l[0];if(y){u.setValue("avatar",y);const x=new FileReader;x.onloadend=()=>{i(x.result)},x.readAsDataURL(y)}};return e.jsxs(we,{open:s,onOpenChange:t,children:[e.jsx(Ce,{asChild:!0,children:a}),e.jsxs(Te,{children:[e.jsxs(ke,{children:[e.jsx(Pe,{children:"Add New Restaurant"}),e.jsx(ws,{children:"Fill in the details for the new restaurant."})]}),e.jsx(ve,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(p),className:"space-y-4",children:[e.jsx(C,{control:u.control,name:"name",render:({field:c})=>e.jsxs(T,{children:[e.jsx(V,{children:"Name"}),e.jsx(k,{children:e.jsx(D,{placeholder:"Restaurant Name",...c})}),e.jsx(S,{})]})}),e.jsx(C,{control:u.control,name:"phoneNumber",render:({field:c})=>e.jsxs(T,{children:[e.jsx(V,{children:"Phone Number"}),e.jsx(k,{children:e.jsx(D,{placeholder:"Phone Number",...c})}),e.jsx(S,{})]})}),e.jsx(C,{control:u.control,name:"address",render:({field:c})=>e.jsxs(T,{children:[e.jsx(V,{children:"Address"}),e.jsx(k,{children:e.jsx(D,{placeholder:"Address",...c})}),e.jsx(S,{})]})}),e.jsx(C,{control:u.control,name:"avatar",render:()=>e.jsxs(T,{children:[e.jsx(bs,{htmlFor:"avatar",children:"Profile Picture"}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[r?e.jsx("img",{src:r,alt:"Preview",className:"w-16 h-16 rounded-full object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"No image"})}),e.jsx(D,{id:"avatar",type:"file",accept:"image/*",onChange:n,className:"cursor-pointer"})]})}),e.jsx(S,{})]})}),e.jsx(C,{control:u.control,name:"cuisineType",render:({field:c})=>e.jsxs(T,{children:[e.jsx(V,{children:"Cuisine Type"}),e.jsxs(ks,{onValueChange:c.onChange,defaultValue:c.value,children:[e.jsx(k,{children:e.jsx(Ps,{children:e.jsx(Ss,{placeholder:"Select a cuisine type"})})}),e.jsxs(Ds,{children:[e.jsx(K,{value:"Indian",children:"Indian"}),e.jsx(K,{value:"Chinese",children:"Chinese"}),e.jsx(K,{value:"Fast Food",children:"Fast Food"}),e.jsx(K,{value:"Other",children:"Other"})]})]}),e.jsx(S,{})]})}),e.jsx(C,{control:u.control,name:"status",render:({field:c})=>e.jsxs(T,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(V,{className:"text-base",children:"Status"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.value?"Active":"Inactive"})]}),e.jsx(k,{children:e.jsx(Cs,{checked:c.value,onCheckedChange:c.onChange})})]})}),e.jsxs(Se,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsx(v,{type:"submit",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding..."]}):"Add Restaurant"})]})]})})]})]})}function rt(){const[s,t]=h.useState(!1),[a,r]=h.useState(null),[i,d]=h.useState(null),u=Y(),{data:g,isLoading:o,isFetchingNextPage:p,hasNextPage:n,fetchNextPage:c,error:y}=fe({queryKey:["restaurants"],queryFn:({pageParam:f=1})=>gs({pageParam:f}),initialPageParam:1,getNextPageParam:(f,b)=>f.totalPages>b.length?b.length+1:void 0,staleTime:1e3*60*5}),{mutate:l,isPending:x}=W({mutationFn:f=>js(f),onSuccess:()=>{u.invalidateQueries({queryKey:["restaurants"]}),B.success("Restaurant deleted successfully")},onError:f=>{B.error(`Failed to delete restaurant: ${f.message}`)}}),j=()=>{i&&l(i)},m=(g==null?void 0:g.pages.flatMap(f=>f.data))||[];return e.jsxs(_,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Restaurants"}),e.jsx(ge,{children:"Manage your restaurant partners and their menus"})]}),e.jsx(at,{open:s,onOpenChange:t,restaurant:a,trigger:e.jsxs(v,{size:"sm",className:"gap-1",children:[e.jsx(_e,{className:"h-4 w-4"})," Add Restaurant"]})})]}),e.jsx(A,{className:"space-y-4",children:o?e.jsx("div",{children:"Loading restaurants..."}):y?e.jsxs("div",{children:["Error: ",y.message]}):e.jsxs(e.Fragment,{children:[m.map(f=>e.jsx(st,{restaurant:f,onEdit:()=>r(f),onDelete:()=>d(f._id),isDeleting:x},f._id)),n&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(v,{onClick:()=>c(),disabled:p,children:p?"Loading...":"Load More"})})]})}),e.jsx(Ue,{open:!!i,onOpenChange:()=>d(null),children:e.jsxs(Ke,{children:[e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Confirm Deletion"}),e.jsx(We,{children:"Are you sure you want to delete this restaurant? This action cannot be undone."})]}),e.jsxs(Xe,{children:[e.jsx(Je,{onClick:()=>d(null),children:"Cancel"}),e.jsx(Ze,{onClick:j,disabled:x,children:x?"Deleting...":"Delete"})]})]})})]})}var[X,Qt]=es("Tooltip",[me]),J=me(),Le="TooltipProvider",nt=700,re="tooltip.open",[lt,le]=X(Le),Oe=s=>{const{__scopeTooltip:t,delayDuration:a=nt,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:d}=s,[u,g]=h.useState(!0),o=h.useRef(!1),p=h.useRef(0);return h.useEffect(()=>{const n=p.current;return()=>window.clearTimeout(n)},[]),e.jsx(lt,{scope:t,isOpenDelayed:u,delayDuration:a,onOpen:h.useCallback(()=>{window.clearTimeout(p.current),g(!1)},[]),onClose:h.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>g(!0),r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:h.useCallback(n=>{o.current=n},[]),disableHoverableContent:i,children:d})};Oe.displayName=Le;var Z="Tooltip",[it,Q]=X(Z),Ie=s=>{const{__scopeTooltip:t,children:a,open:r,defaultOpen:i=!1,onOpenChange:d,disableHoverableContent:u,delayDuration:g}=s,o=le(Z,s.__scopeTooltip),p=J(t),[n,c]=h.useState(null),y=ss(),l=h.useRef(0),x=u??o.disableHoverableContent,j=g??o.delayDuration,m=h.useRef(!1),[f=!1,b]=ts({prop:r,defaultProp:i,onChange:ce=>{ce?(o.onOpen(),document.dispatchEvent(new CustomEvent(re))):o.onClose(),d==null||d(ce)}}),I=h.useMemo(()=>f?m.current?"delayed-open":"instant-open":"closed",[f]),q=h.useCallback(()=>{window.clearTimeout(l.current),l.current=0,m.current=!1,b(!0)},[b]),H=h.useCallback(()=>{window.clearTimeout(l.current),l.current=0,b(!1)},[b]),oe=h.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>{m.current=!0,b(!0),l.current=0},j)},[j,b]);return h.useEffect(()=>()=>{l.current&&(window.clearTimeout(l.current),l.current=0)},[]),e.jsx(as,{...p,children:e.jsx(it,{scope:t,contentId:y,open:f,stateAttribute:I,trigger:n,onTriggerChange:c,onTriggerEnter:h.useCallback(()=>{o.isOpenDelayed?oe():q()},[o.isOpenDelayed,oe,q]),onTriggerLeave:h.useCallback(()=>{x?H():(window.clearTimeout(l.current),l.current=0)},[H,x]),onOpen:q,onClose:H,disableHoverableContent:x,children:a})})};Ie.displayName=Z;var ne="TooltipTrigger",qe=h.forwardRef((s,t)=>{const{__scopeTooltip:a,...r}=s,i=Q(ne,a),d=le(ne,a),u=J(a),g=h.useRef(null),o=pe(t,g,i.onTriggerChange),p=h.useRef(!1),n=h.useRef(!1),c=h.useCallback(()=>p.current=!1,[]);return h.useEffect(()=>()=>document.removeEventListener("pointerup",c),[c]),e.jsx(rs,{asChild:!0,...u,children:e.jsx(ns.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:o,onPointerMove:F(s.onPointerMove,y=>{y.pointerType!=="touch"&&!n.current&&!d.isPointerInTransitRef.current&&(i.onTriggerEnter(),n.current=!0)}),onPointerLeave:F(s.onPointerLeave,()=>{i.onTriggerLeave(),n.current=!1}),onPointerDown:F(s.onPointerDown,()=>{p.current=!0,document.addEventListener("pointerup",c,{once:!0})}),onFocus:F(s.onFocus,()=>{p.current||i.onOpen()}),onBlur:F(s.onBlur,i.onClose),onClick:F(s.onClick,i.onClose)})})});qe.displayName=ne;var ie="TooltipPortal",[ot,ct]=X(ie,{forceMount:void 0}),He=s=>{const{__scopeTooltip:t,forceMount:a,children:r,container:i}=s,d=Q(ie,t);return e.jsx(ot,{scope:t,forceMount:a,children:e.jsx(je,{present:a||d.open,children:e.jsx(ls,{asChild:!0,container:i,children:r})})})};He.displayName=ie;var O="TooltipContent",Ve=h.forwardRef((s,t)=>{const a=ct(O,s.__scopeTooltip),{forceMount:r=a.forceMount,side:i="top",...d}=s,u=Q(O,s.__scopeTooltip);return e.jsx(je,{present:r||u.open,children:u.disableHoverableContent?e.jsx(ze,{side:i,...d,ref:t}):e.jsx(dt,{side:i,...d,ref:t})})}),dt=h.forwardRef((s,t)=>{const a=Q(O,s.__scopeTooltip),r=le(O,s.__scopeTooltip),i=h.useRef(null),d=pe(t,i),[u,g]=h.useState(null),{trigger:o,onClose:p}=a,n=i.current,{onPointerInTransitChange:c}=r,y=h.useCallback(()=>{g(null),c(!1)},[c]),l=h.useCallback((x,j)=>{const m=x.currentTarget,f={x:x.clientX,y:x.clientY},b=xt(f,m.getBoundingClientRect()),I=mt(f,b),q=pt(j.getBoundingClientRect()),H=gt([...I,...q]);g(H),c(!0)},[c]);return h.useEffect(()=>()=>y(),[y]),h.useEffect(()=>{if(o&&n){const x=m=>l(m,n),j=m=>l(m,o);return o.addEventListener("pointerleave",x),n.addEventListener("pointerleave",j),()=>{o.removeEventListener("pointerleave",x),n.removeEventListener("pointerleave",j)}}},[o,n,l,y]),h.useEffect(()=>{if(u){const x=j=>{const m=j.target,f={x:j.clientX,y:j.clientY},b=(o==null?void 0:o.contains(m))||(n==null?void 0:n.contains(m)),I=!jt(f,u);b?y():I&&(y(),p())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[o,n,u,p,y]),e.jsx(ze,{...s,ref:d})}),[ut,ht]=X(Z,{isInside:!1}),ze=h.forwardRef((s,t)=>{const{__scopeTooltip:a,children:r,"aria-label":i,onEscapeKeyDown:d,onPointerDownOutside:u,...g}=s,o=Q(O,a),p=J(a),{onClose:n}=o;return h.useEffect(()=>(document.addEventListener(re,n),()=>document.removeEventListener(re,n)),[n]),h.useEffect(()=>{if(o.trigger){const c=y=>{const l=y.target;l!=null&&l.contains(o.trigger)&&n()};return window.addEventListener("scroll",c,{capture:!0}),()=>window.removeEventListener("scroll",c,{capture:!0})}},[o.trigger,n]),e.jsx(os,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:c=>c.preventDefault(),onDismiss:n,children:e.jsxs(cs,{"data-state":o.stateAttribute,...p,...g,ref:t,style:{...g.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(ds,{children:r}),e.jsx(ut,{scope:a,isInside:!0,children:e.jsx(_s,{id:o.contentId,role:"tooltip",children:i||r})})]})})});Ve.displayName=O;var $e="TooltipArrow",Be=h.forwardRef((s,t)=>{const{__scopeTooltip:a,...r}=s,i=J(a);return ht($e,a).isInside?null:e.jsx(is,{...i,...r,ref:t})});Be.displayName=$e;function xt(s,t){const a=Math.abs(t.top-s.y),r=Math.abs(t.bottom-s.y),i=Math.abs(t.right-s.x),d=Math.abs(t.left-s.x);switch(Math.min(a,r,i,d)){case d:return"left";case i:return"right";case a:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function mt(s,t,a=5){const r=[];switch(t){case"top":r.push({x:s.x-a,y:s.y+a},{x:s.x+a,y:s.y+a});break;case"bottom":r.push({x:s.x-a,y:s.y-a},{x:s.x+a,y:s.y-a});break;case"left":r.push({x:s.x+a,y:s.y-a},{x:s.x+a,y:s.y+a});break;case"right":r.push({x:s.x-a,y:s.y-a},{x:s.x-a,y:s.y+a});break}return r}function pt(s){const{top:t,right:a,bottom:r,left:i}=s;return[{x:i,y:t},{x:a,y:t},{x:a,y:r},{x:i,y:r}]}function jt(s,t){const{x:a,y:r}=s;let i=!1;for(let d=0,u=t.length-1;d<t.length;u=d++){const g=t[d].x,o=t[d].y,p=t[u].x,n=t[u].y;o>r!=n>r&&a<(p-g)*(r-o)/(n-o)+g&&(i=!i)}return i}function gt(s){const t=s.slice();return t.sort((a,r)=>a.x<r.x?-1:a.x>r.x?1:a.y<r.y?-1:a.y>r.y?1:0),ft(t)}function ft(s){if(s.length<=1)return s.slice();const t=[];for(let r=0;r<s.length;r++){const i=s[r];for(;t.length>=2;){const d=t[t.length-1],u=t[t.length-2];if((d.x-u.x)*(i.y-u.y)>=(d.y-u.y)*(i.x-u.x))t.pop();else break}t.push(i)}t.pop();const a=[];for(let r=s.length-1;r>=0;r--){const i=s[r];for(;a.length>=2;){const d=a[a.length-1],u=a[a.length-2];if((d.x-u.x)*(i.y-u.y)>=(d.y-u.y)*(i.x-u.x))a.pop();else break}a.push(i)}return a.pop(),t.length===1&&a.length===1&&t[0].x===a[0].x&&t[0].y===a[0].y?t:t.concat(a)}var yt=Oe,vt=Ie,bt=qe,Nt=He,wt=Ve,Ct=Be;function Tt({delayDuration:s=0,...t}){return e.jsx(yt,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function kt({...s}){return e.jsx(Tt,{children:e.jsx(vt,{"data-slot":"tooltip",...s})})}function Pt({...s}){return e.jsx(bt,{"data-slot":"tooltip-trigger",...s})}function St({className:s,sideOffset:t=0,children:a,...r}){return e.jsx(Nt,{children:e.jsxs(wt,{"data-slot":"tooltip-content",sideOffset:t,className:E("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...r,children:[a,e.jsx(Ct,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Dt={placed:"bg-amber-100 text-amber-800",confirmed:"bg-blue-100 text-blue-800",preparing:"bg-indigo-100 text-indigo-800","on the way":"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},de={placed:["confirm","cancel"],confirmed:["start preparing","cancel"],preparing:["mark as ready","cancel"],"on the way":["mark as delivered"],delivered:[],cancelled:[]};function _t(){const s=Y(),{data:t,isLoading:a,isError:r,fetchNextPage:i,hasNextPage:d,isFetchingNextPage:u,refetch:g}=fe({queryKey:["orders"],queryFn:({pageParam:l=1})=>Rs({pageParam:l}),initialPageParam:1,getNextPageParam:(l,x)=>l.totalPages>x.length?x.length+1:void 0}),{mutate:o,isPending:p}=W({mutationFn:async({orderId:l,status:x})=>{if(await Ms(l,x),x==="delivered"){const j=c.find(m=>m._id===l);(j==null?void 0:j.payment.paymentMethod)==="Cash on Delivery"&&j.payment.status==="pending"&&await As(j.payment._id,"paid")}},onMutate:async({orderId:l,status:x})=>{await s.invalidateQueries({queryKey:["orders"]});const j=s.getQueryData(["orders"]);return s.setQueryData(["orders"],m=>({...m,pages:m.pages.map(f=>({...f,data:f.data.map(b=>b._id===l?{...b,status:x}:b)}))})),{previousOrders:j}},onError:(l,x,j)=>{j!=null&&j.previousOrders&&s.setQueryData(["orders"],j.previousOrders),B("Failed to update order status")},onSettled:()=>{s.invalidateQueries({queryKey:["orders"]})}}),n=(l,x)=>{const m={confirm:"confirmed",cancel:"cancelled","start preparing":"preparing","mark as ready":"on the way","mark as delivered":"delivered"}[x]||x;o({orderId:l,status:m})};if(a)return e.jsxs(_,{className:"rounded-lg border shadow-sm",children:[e.jsxs(M,{children:[e.jsx(R,{className:"text-xl font-semibold",children:"Orders"}),e.jsx("div",{className:"animate-pulse h-4 w-48 bg-gray-200 rounded"})]}),e.jsx(A,{className:"flex justify-center py-12",children:e.jsx(U,{className:"h-8 w-8 animate-spin text-primary"})})]});if(r)return e.jsxs(_,{className:"rounded-lg border shadow-sm",children:[e.jsx(M,{children:e.jsx(R,{className:"text-xl font-semibold",children:"Orders"})}),e.jsxs(A,{className:"text-center py-12 space-y-4",children:[e.jsx("div",{className:"text-red-500 font-medium",children:"Failed to load orders"}),e.jsxs(v,{variant:"outline",onClick:()=>g(),className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Retry"]})]})]});const c=(t==null?void 0:t.pages.flatMap(l=>l.data))||[],y=c.length===0;return console.log(c),y?e.jsxs(_,{className:"rounded-lg border shadow-sm",children:[e.jsx(M,{children:e.jsx(R,{className:"text-xl font-semibold",children:"Orders"})}),e.jsxs(A,{className:"text-center py-12 space-y-4",children:[e.jsx(us,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("div",{className:"text-lg font-medium",children:"No orders yet"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-md mx-auto",children:"When customers place orders, they will appear here for management."})]})]}):e.jsxs(_,{className:"rounded-lg border shadow-sm overflow-hidden",children:[e.jsx(M,{className:"bg-gray-50 px-6 py-4 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(R,{className:"text-xl font-semibold",children:"Order Management"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.length," order",c.length!==1?"s":""," • Sorted by recent"]})]}),e.jsxs(v,{variant:"outline",size:"sm",className:"gap-1",children:["Filters ",e.jsx(ae,{className:"h-4 w-4"})]})]})}),e.jsxs(A,{className:"p-0",children:[e.jsxs(Ae,{children:[e.jsx(Ee,{className:"bg-gray-50",children:e.jsxs(G,{children:[e.jsx(N,{className:"w-[120px]",children:"Order ID"}),e.jsx(N,{children:"Customer"}),e.jsx(N,{className:"w-[250px]",children:"Items"}),e.jsx(N,{children:"Amount"}),e.jsx(N,{children:"Status"}),e.jsx(N,{children:"Delivery Info"}),e.jsx(N,{children:"Payment"}),e.jsx(N,{children:"Payment Status"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(Fe,{children:c.map(l=>{var x,j;return e.jsxs(G,{className:"hover:bg-gray-50",children:[e.jsxs(w,{className:"font-medium",children:[e.jsxs("div",{className:"font-semibold",children:["#",l._id.slice(-6).toUpperCase()]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(l.createdAt).toLocaleDateString()})]}),e.jsxs(w,{children:[e.jsx("div",{className:"font-medium",children:(x=l.addressId)==null?void 0:x.receiverName}),e.jsx("div",{className:"text-xs text-muted-foreground",children:(j=l.addressId)==null?void 0:j.phoneNumber})]}),e.jsx(w,{children:e.jsx("div",{className:"space-y-2 max-h-[120px] overflow-y-auto pr-2",children:l.menuItems.map((m,f)=>e.jsxs("div",{className:"border-b pb-2 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:[m.quantity,"x ",m.item.name]}),e.jsxs("span",{children:["₹",(m.item.price*m.quantity).toFixed(2)]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:m.restaurant.name})]},`${l._id}-${f}`))})}),e.jsxs(w,{className:"font-semibold",children:["₹",l.totalAmount.toFixed(2)]}),e.jsx(w,{children:e.jsx(te,{className:`${Dt[l.status]} capitalize`,children:l.status})}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.deliveryTime}),l.deliveryInstructions&&e.jsxs(kt,{children:[e.jsx(Pt,{asChild:!0,children:e.jsx(Ls,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsxs(St,{className:"max-w-[300px]",children:[e.jsx("p",{className:"font-medium mb-1",children:"Delivery Instructions:"}),e.jsx("p",{className:"text-sm",children:l.deliveryInstructions})]})]})]})}),e.jsx(w,{children:e.jsx(te,{variant:"outline",className:"capitalize",children:l.payment.paymentMethod.toLowerCase()})}),e.jsx(w,{children:e.jsx(te,{variant:"outline",className:"border-green-500 text-green-500",children:l.payment.status})}),e.jsx(w,{className:"text-right",children:e.jsxs(ue,{children:[e.jsx(he,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(De,{className:"h-4 w-4"})})}),e.jsxs(xe,{align:"end",children:[de[l.status].map(m=>e.jsxs($,{onSelect:()=>n(l._id,m),disabled:p,children:[m.charAt(0).toUpperCase()+m.slice(1),p&&e.jsx(U,{className:"ml-2 h-3 w-3 animate-spin"})]},m)),e.jsx($,{onSelect:()=>console.log("View details",l._id),children:"View details"}),e.jsx($,{className:"text-red-600",onSelect:()=>n(l._id,"cancelled"),disabled:!de[l.status].includes("cancel")||p,children:"Cancel order"})]})]})})]},l._id)})})]}),d&&e.jsx("div",{className:"flex justify-center p-4 border-t",children:e.jsx(v,{onClick:()=>i(),disabled:u,variant:"outline",className:"gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):e.jsxs(e.Fragment,{children:["Load more",e.jsx(ae,{className:"h-4 w-4"})]})})})]})]})}function Mt(){return e.jsxs(_,{children:[e.jsxs(M,{children:[e.jsx(R,{children:"Admin Settings"}),e.jsx(ge,{children:"Configure your admin preferences"})]}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium",children:"System Preferences"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{placeholder:"Delivery Fee",className:"w-32"}),e.jsx(v,{variant:"outline",children:"Update"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium",children:"Notification Settings"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm",children:[e.jsx("option",{children:"Email Notifications"}),e.jsx("option",{children:"SMS Notifications"}),e.jsx("option",{children:"Push Notifications"})]}),e.jsx(v,{variant:"outline",children:"Save"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium",children:"Security"}),e.jsx(v,{variant:"outline",children:"Change Password"})]})]}),e.jsx(ms,{className:"border-t px-6 py-4",children:e.jsx(v,{variant:"outline",children:"Save All Settings"})})]})}function Ut(){return e.jsx("div",{className:"p-4 md:p-6",children:e.jsxs(hs,{defaultValue:"restaurants",className:"space-y-4",children:[e.jsxs(xs,{children:[e.jsxs(ee,{value:"restaurants",className:"flex gap-2",children:[e.jsx(Re,{className:"h-4 w-4"})," Restaurants"]}),e.jsxs(ee,{value:"orders",className:"flex gap-2",children:[e.jsx(Is,{className:"h-4 w-4"})," Orders"]}),e.jsxs(ee,{value:"settings",className:"flex gap-2",children:[e.jsx(Bs,{className:"h-4 w-4"})," Settings"]})]}),e.jsx(se,{value:"restaurants",className:"space-y-4",children:e.jsx(rt,{})}),e.jsx(se,{value:"orders",className:"space-y-4",children:e.jsx(_t,{})}),e.jsx(se,{value:"settings",className:"space-y-4",children:e.jsx(Mt,{})})]})})}export{Ut as default};
