import{b as M,U as $,r as b,a as F,_ as B,$ as K,j as e,a0 as Q,a1 as R,a2 as V,B as l,a3 as Y,L as O,Y as H,t as v,M as E,a4 as G,a5 as J,a6 as W,a7 as X,a8 as Z,a9 as ee,aa as se,ab as ae,V as te}from"./index-DHMpdurn.js";import{P as I,T as ne,a as le,b as k,c as D}from"./tabs-D59OUTXK.js";import{u as S}from"./useInfiniteQuery-Coer8mqO.js";import{g as ie}from"./order-BaTwK9at.js";import{d as re,s as de,A as ce,f as oe}from"./AddressForm-BQNr6LT5.js";import{C as c}from"./card-BQe6pRQb.js";import{I as L}from"./input-DYNcJkZt.js";import{m as T}from"./proxy-CVmDK4PK.js";import{C as me}from"./clock-_xkOYcMI.js";import"./form-BLV7FBNs.js";import"./switch-BloYoOuj.js";import"./select-Dlj259sK.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],_=M("Pen",xe);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],q=M("TriangleAlert",he);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],U=M("User",ue);function pe({user:a}){var n,i;const d=$(),[p,o]=b.useState(!1),[m,x]=b.useState({userName:(a==null?void 0:a.userName)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||""}),{mutate:f,isPending:h,isError:t}=F({mutationFn:B,onSuccess:r=>{d(K(r.user)),x(r.user),o(!1)},onError:r=>{console.error("Update failed",r)}}),u=r=>{x({...m,[r.target.name]:r.target.value})},j=()=>{f(m)};return a?p?e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"max-w-2xl space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(U,{className:"h-10 w-10 text-primary"})}),e.jsx(l,{variant:"outline",size:"sm",children:"Change Photo"})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Full Name"}),e.jsx(L,{name:"userName",value:m.userName,onChange:u})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Phone"}),e.jsx(L,{name:"phoneNumber",value:m.phoneNumber,onChange:u})]})]}),t&&e.jsx("p",{className:"text-sm text-red-500",children:"Failed to update profile. Please try again."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:j,disabled:h,children:h?e.jsxs("span",{className:"flex gap-1 items-center",children:[e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.2s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.1s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce"})]}):"Save Changes"}),e.jsx(l,{variant:"outline",onClick:()=>o(!1),children:"Cancel"})]})]})}):e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"max-w-2xl space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-15 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsxs(Q,{className:"size-15",children:[e.jsx(R,{src:a==null?void 0:a.avatar,alt:a==null?void 0:a.userName}),e.jsx(V,{children:((i=(n=a==null?void 0:a.userName)==null?void 0:n.charAt(0))==null?void 0:i.toUpperCase())||"U"})]})}),e.jsxs("div",{className:"flex flex-col justify-start items-start",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:a==null?void 0:a.userName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Member since ",a==null?void 0:a.createdAt]})]})]}),e.jsxs(l,{variant:"outline",onClick:()=>o(!0),className:"flex items-end gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Edit"]})]}),e.jsx("div",{className:"space-y-4 mt-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:a==null?void 0:a.phoneNumber})]})})]})}):e.jsx(c,{className:"p-6",children:e.jsx("div",{className:"max-w-2xl space-y-6",children:e.jsx("p",{children:"No user data available"})})})}function z(){return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 h-fit w-full bg-white",children:[e.jsxs("div",{className:"relative h-16 w-16",children:[e.jsx(T.div,{className:"absolute left-2 h-10 w-2 bg-black rounded-full origin-bottom",animate:{rotate:[-30,20,-30]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}),e.jsx(T.div,{className:"absolute right-2 h-10 w-2 bg-black rounded-full origin-bottom",animate:{rotate:[30,-20,30]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})]}),e.jsx(T.p,{className:"text-sm font-medium text-black",animate:{opacity:[.6,1,.6]},transition:{duration:2,repeat:1/0},children:"Dine Express is setting the table for your cravings..."})]})}const fe=20;function je({orders:a,isLoading:d,isError:p,isEmpty:o,hasNextPage:m,isFetchingNextPage:x,refetch:f,fetchNextPage:h}){return d?e.jsx("div",{className:"flex flex-col gap-4",children:[1,2].map(t=>e.jsx(c,{className:"p-6",children:e.jsx(z,{})},t))}):p?e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(q,{className:"h-8 w-8 mx-auto text-red-500"}),e.jsx("h3",{className:"font-medium",children:"Failed to load orders"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"There was an error loading your orders. Please try again."}),e.jsx(l,{variant:"outline",className:"mt-4",onClick:()=>f(),children:"Retry"})]})}):o?e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(I,{className:"h-8 w-8 mx-auto text-muted-foreground"}),e.jsx("h3",{className:"font-medium",children:"No orders yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your order history will appear here once you place an order."}),e.jsx(l,{className:"mt-4",children:"Browse Restaurants"})]})}):e.jsxs("div",{className:"space-y-4",children:[a==null?void 0:a.map(t=>{const u=Array.from(new Set(t.menuItems.map(n=>{var i;return(i=n.restaurant)==null?void 0:i.name}))).join(", "),j=t.menuItems.reduce((n,{item:{price:i},quantity:r})=>n+i*r,0);return e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:u}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Order #",t._id.slice(-6).toUpperCase()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="delivered"?"bg-green-100 text-green-800":t.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[e.jsx(me,{className:"inline h-3 w-3 mr-1"}),new Date(t.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"space-y-2",children:[t.menuItems.map((n,i)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[n.quantity,"x ",n.item.name]}),e.jsxs("span",{children:["₹",n.item.price*n.quantity]})]},i)),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:"Delivery Charges"}),e.jsx("span",{children:`₹${fe}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:"Taxes & Charges"}),e.jsxs("span",{children:["₹",Math.round(j*.05)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.paymentMethod," • ",t.deliveryTime]}),t.deliveryInstructions&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Note: ",t.deliveryInstructions]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"font-medium",children:"Total Amount"}),e.jsxs("span",{className:"font-semibold block",children:["₹",t.totalAmount]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(O,{to:`/order-confirmation/${t._id}`,children:e.jsx(l,{variant:"outline",className:"w-full",children:"Track Order"})}),e.jsx(O,{to:`/order-confirmation/${t._id}`,children:e.jsx(l,{variant:"outline",className:"w-full",children:"View Details"})})]})]})},t._id)}),m&&e.jsx("div",{className:"flex justify-center",children:e.jsx(l,{variant:"outline",onClick:()=>h(),disabled:x,children:x?"Loading more...":"Load More"})})]})}function Ne({addresses:a,isLoading:d,isError:p,isFetchingNextPage:o,hasNextPage:m,fetchNextPage:x,refetch:f}){const h=H(),[t,u]=b.useState(!1),[j,n]=b.useState(!1),[i,r]=b.useState(null),N=F({mutationFn:re,onSuccess:()=>{h.invalidateQueries({queryKey:["addresses"]}),v.success("Address deleted successfully")},onError:s=>{v.error(s.message||"Failed to delete address")}}),g=F({mutationFn:de,onSuccess:()=>{h.invalidateQueries({queryKey:["addresses"]}),v.success("Default address updated successfully")},onError:s=>{v.error(s.message||"Failed to set default address")}}),A=()=>{i&&N.mutate(i),n(!1)},C=s=>{r(s),n(!0)},w=s=>{g.mutate(s)},P=()=>{v.info("Address editing feature is coming soon!",{description:"You'll be able to edit your addresses in the next update."})};return d&&!o?e.jsx("div",{className:"flex flex-col gap-4",children:[1,2].map(s=>e.jsx(c,{className:"p-6",children:e.jsx(z,{})},s))}):p?e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(q,{className:"h-8 w-8 mx-auto text-red-500"}),e.jsx("h3",{className:"font-medium",children:"Failed to load addresses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"There was an error loading your addresses. Please try again."}),e.jsx(l,{variant:"outline",className:"mt-4",onClick:()=>f(),children:"Retry"})]})}):a.length===0?e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(E,{className:"h-8 w-8 mx-auto text-muted-foreground"}),e.jsx("h3",{className:"font-medium",children:"No addresses saved"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add an address to make ordering faster"})]})}):e.jsxs("div",{className:"space-y-4",children:[a.map(s=>e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.type}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.receiverName}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.address}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Phone: ",s.phoneNumber]}),s.isDefault&&e.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 text-xs font-medium bg-primary/10 text-primary rounded-full",children:"Default"})]}),e.jsx(l,{variant:"ghost",size:"icon",onClick:P,children:e.jsx(_,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[!s.isDefault&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>w(s._id),disabled:g.isPending,children:g.isPending?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"dot w-2 h-2 bg-primary rounded-full animate-bounce [animation-delay:-0.2s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-primary rounded-full animate-bounce [animation-delay:-0.1s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-primary rounded-full animate-bounce"})]}):"Set as Default"}),e.jsx(l,{variant:"destructive",size:"sm",onClick:()=>C(s._id),disabled:N.isPending||s.isDefault,children:"Delete"})]})]},s._id)),m&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(l,{variant:"outline",onClick:()=>x(),disabled:o,className:"w-full sm:w-auto",children:o?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"dot w-2 h-2 bg-primary rounded-full animate-bounce [animation-delay:-0.2s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-primary rounded-full animate-bounce [animation-delay:-0.1s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-primary rounded-full animate-bounce"})]}):"Load More Addresses"})}),e.jsx(c,{className:"p-6 border-dashed",children:e.jsxs(l,{variant:"outline",className:"w-full",onClick:()=>u(!0),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Add New Address"]})}),e.jsx(ce,{openAddressForm:t,setOpenAddressForm:u}),e.jsx(G,{open:j,onOpenChange:n,children:e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:"Are you sure?"}),e.jsx(Z,{children:"This action cannot be undone. This will permanently delete this address."})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(ae,{onClick:A,disabled:N.isPending,children:N.isPending?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.2s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.1s]"}),e.jsx("span",{className:"dot w-2 h-2 bg-white rounded-full animate-bounce"})]}):"Delete"})]})]})})]})}function Ee(){var w,P;const{user:a}=te(s=>s.user),{data:d,isLoading:p,isError:o,isFetchingNextPage:m,hasNextPage:x,fetchNextPage:f,refetch:h}=S({queryKey:["orders"],queryFn:({pageParam:s})=>ie({pageParam:s}),initialPageParam:1,getNextPageParam:(s,y)=>s.totalPages>y.length?y.length+1:void 0,staleTime:1e3*60*5}),{data:t,isLoading:u,isError:j,isFetchingNextPage:n,hasNextPage:i,fetchNextPage:r,refetch:N}=S({queryKey:["addresses"],queryFn:({pageParam:s=1})=>oe(s),initialPageParam:1,getNextPageParam:(s,y)=>s.totalPages>y.length?y.length+1:void 0,retry:!1,staleTime:1e3*60*5}),g=(w=d==null?void 0:d.pages)==null?void 0:w.every(s=>s.data.length===0),A=((P=d==null?void 0:d.pages)==null?void 0:P.flatMap(s=>s.data))||[],C=(t==null?void 0:t.pages.flatMap(s=>s.data))||[];return a?e.jsxs("div",{className:"container py-8 max-w-4xl mx-auto lg:w-4xl w-dvw md-p-0 p-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"My Profile"}),e.jsxs(ne,{defaultValue:"profile",className:"space-y-6",children:[e.jsxs(le,{children:[e.jsxs(k,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Profile"]}),e.jsxs(k,{value:"orders",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Orders"]}),e.jsxs(k,{value:"addresses",className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Addresses"]})]}),e.jsx(D,{value:"profile",children:e.jsx(pe,{user:a})}),e.jsx(D,{value:"orders",children:e.jsx(je,{orders:A,isLoading:p,isError:o,isEmpty:g,hasNextPage:x,isFetchingNextPage:m,refetch:h,fetchNextPage:f})}),e.jsx(D,{value:"addresses",children:e.jsx(Ne,{addresses:C,isLoading:u,isError:j,isFetchingNextPage:n,hasNextPage:i,fetchNextPage:r,refetch:N})})]})]}):e.jsxs("div",{className:"container py-8 max-w-4xl mx-auto lg:w-4xl w-dvw md-p-0 p-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"My Profile"}),e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{children:"Please sign in to view your profile"})})]})}export{Ee as default};
